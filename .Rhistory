pull(request) %>%
paste0(collapse = " OR ")
Scopus_Request
scopus_data <- readFiles("bdd_biblio/scopus_doi.bib") %>%
convert2df(dbsource = "scopus", format = "bibtext") %>% tbl_df() %>%
select(DOI = DI,nb_citations = TC) %>%
arrange(desc(nb_citations))
scopus_data
WoS_request <- bib_df %>% distinct(BIBTEXKEY,DOI) %>% drop_na() %>%
mutate(DOI = str_remove(DOI,"http://dx.doi.org/")) %>%
mutate(request = paste0("DO=(",DOI,")")) %>%
pull(request) %>%
paste0(collapse = " OR ")
WoS_request <- base_doi %>%
mutate(request = paste0("DO=(",DOI,")")) %>%
pull(request) %>%
paste0(collapse = " OR ")
WoS_request
?convert2df
readFiles("bdd_biblio/scopus_doi.bib") %>%
convert2df(dbsource = "wos", format = "bibtext") %>% tbl_df() %>%
select(DOI = DI,nb_citations = TC) %>%
arrange(desc(nb_citations))
readFiles("bdd_biblio/wos_doi.bib") %>%
convert2df(dbsource = "wos", format = "bibtext") %>%
tbl_df() %>%
select(DOI = DI,nb_citations = TC) %>%
arrange(desc(nb_citations))
readFiles("bdd_biblio/wos_doi.bib") %>%
convert2df(dbsource = "wos", format = "bibtext")
readFiles("bdd_biblio/wos_doi.bib") %>%
convert2df(dbsource = "wos", format = "bibtex") %>%
tbl_df() %>%
select(DOI = DI,nb_citations = TC) %>%
arrange(desc(nb_citations))
scopus_data <- readFiles("bdd_biblio/scopus_doi.bib") %>%
convert2df(dbsource = "scopus", format = "bibtex") %>% tbl_df() %>%
select(DOI = DI,nb_citations = TC) %>%
arrange(desc(nb_citations))
readFiles("bdd_biblio/wos_doi.bib") %>%
convert2df(dbsource = "wos", format = "bibtex")
readFiles("bdd_biblio/wos_doi.bib") %>%
convert2df(dbsource = "wos", format = "bibtex") %>%
tbl_df()
readFiles("bdd_biblio/wos_doi.bib") %>%
convert2df(dbsource = "wos", format = "bibtex") %>%
tbl_df() %>%
select(DOI = DI,nb_citations = TC) %>%
arrange(desc(nb_citations))
readFiles("bdd_biblio/wos_doi.bib") %>%
convert2df(dbsource = "wos", format = "bibtex") %>%
tbl_df() %>%
select(DOI = DI,nb_citations = TC) %>%
arrange(desc(nb_citations)) %>% drop_na(nb_citations)
base_doi
scopus_data
scopus_data %>% mutate(DOI = tolower(DOI))
scopus_data %>% mutate(DOI = tolower(DOI)) %>% inner_join(base_doi %>% mutate(DOI = tolower(DOI)), by = "DOI")
scopus_data %>% mutate(DOI = tolower(DOI)) %>% inner_join(base_doi %>% mutate(DOI = tolower(DOI)), by = "DOI") %>% View()
base_doi
doi_ok
## Ces entrées ont un DOI OK
doi_ok <- complement_doi %>% filter(str_detect(DOI,"10.")) %>% select(-citations)
## Base des DOI
base_doi <- bib_df %>%
filter(NOTE %in% c("Article de revue scientifique à comité de lecture","Communication scientifique avec actes")) %>%
select(BIBTEXKEY,AUTHOR,TITLE,DOI) %>%
mutate(DOI = str_remove_all(DOI,"http://dx.doi.org/")) %>%
filter(!BIBTEXKEY %in% doi_ok$BIBTEXKEY) %>%
bind_rows(doi_ok) %>% drop_na(DOI)
scopus_data %>% mutate(DOI = tolower(DOI)) %>% inner_join(base_doi %>% mutate(DOI = tolower(DOI)), by = "DOI")
scopus_data %>% mutate(DOI = tolower(DOI)) %>% inner_join(base_doi %>% mutate(DOI = tolower(DOI)), by = "DOI") %>% select(BIBTEXKEY,nb_citations)
citations
## Ces entrées n'ont pas de DOI mais j'ai relevé quand possible leur nombre de citations
citations <- complement_doi %>% filter(!is.na(citations)) %>% rename(nb_citations=citations) %>%
select(BIBTEXKEY,nb_citations)
scopus_data %>% mutate(DOI = tolower(DOI)) %>% inner_join(base_doi %>% mutate(DOI = tolower(DOI)), by = "DOI") %>% select(BIBTEXKEY,nb_citations) %>% bind_rows(citations)
58+16
doi_hal
scopus_data %>%
mutate(DOI = tolower(DOI)) %>%
inner_join(base_doi %>% mutate(DOI = tolower(DOI)), by = "DOI") %>%
select(BIBTEXKEY,nb_citations) %>%
bind_rows(citations)
scopus_data %>%
mutate(DOI = tolower(DOI)) %>%
inner_join(base_doi %>% mutate(DOI = tolower(DOI)), by = "DOI") %>%
select(BIBTEXKEY,nb_citations) %>%
bind_rows(citations) %>%
full_join(bib_df, by = "BIBTEXKEY")
new_bib_df <- scopus_data %>%
mutate(DOI = tolower(DOI)) %>%
inner_join(base_doi %>% mutate(DOI = tolower(DOI)), by = "DOI") %>%
select(BIBTEXKEY,nb_citations) %>%
bind_rows(citations) %>%
full_join(bib_df, by = "BIBTEXKEY")
new_bib_df %>% distinct(NOTE,nb_citations)
new_bib_df %>% select(NOTE,nb_citations)
new_bib_df %>% select(BIBTEXKEY,NOTE,nb_citations)
new_bib_df %>% drop_na(nb_citations)
new_bib_df %>% drop_na(nb_citations) %>% count(NOTE)
new_bib_df %>% count(NOTE)
new_bib_df %>% filter(is.na(nb_citations) & NOTE == "Article de revue scientifique à comité de lecture")
new_bib_df %>% filter(is.na(nb_citations) & NOTE == "Article de revue scientifique à comité de lecture") %>% select(AUTHOR,TITLE)
new_bib_df %>% filter(is.na(nb_citations) & NOTE == "Article de revue scientifique à comité de lecture") %>% select(AUTHOR,TITLE, DOI)
new_bib_df %>% filter(is.na(nb_citations) & NOTE == "Article de revue scientifique à comité de lecture") %>% select(AUTHOR,TITLE, DOI) %>% View()
new_bib_df %>% filter(is.na(nb_citations) & NOTE == "Article de revue scientifique à comité de lecture") %>% select(BIBTEXKEY,AUTHOR,TITLE, DOI) %>% View()
new_bib_df %>% filter(is.na(nb_citations) & NOTE == "Article de revue scientifique à comité de lecture") %>% select(AUTHOR,TITLE, DOI) %>% openxlsx::write.xlsx("to_add.xlsx")
new_bib_df %>% filter(is.na(nb_citations) & NOTE == "Article de revue scientifique à comité de lecture") %>% select(BIBTEXKEY,AUTHOR,TITLE, DOI) %>% openxlsx::write.xlsx("to_add.xlsx")
## J'ai retrouvé quelques DOI à la main
complement_doi <- read_csv2("complement_doi.csv")
## J'ai retrouvé quelques DOI à la main
complement_doi <- read_csv2("complement_doi.csv")
## Ces entrées ne sont que dans HAL (aucune info citation)
doi_hal <- complement_doi %>% filter(str_detect(DOI,"hal-"))
## Ces entrées ont un DOI OK
doi_ok <- complement_doi %>% filter(str_detect(DOI,"10.")) %>% select(-citations)
## Ces entrées n'ont pas de DOI mais j'ai relevé quand possible leur nombre de citations
citations <- complement_doi %>% filter(!is.na(citations)) %>% rename(nb_citations=citations) %>%
select(BIBTEXKEY,nb_citations)
citations
## J'ai retrouvé quelques DOI à la main
complement_doi <- read_csv2("complement_doi.csv")
## Ces entrées ne sont que dans HAL (aucune info citation)
doi_hal <- complement_doi %>% filter(str_detect(DOI,"hal-"))
## Ces entrées ont un DOI OK
doi_ok <- complement_doi %>% filter(str_detect(DOI,"10.")) %>% select(-citations)
## Ces entrées n'ont pas de DOI mais j'ai relevé quand possible leur nombre de citations
citations <- complement_doi %>% filter(!is.na(citations)) %>% rename(nb_citations=citations) %>%
select(BIBTEXKEY,nb_citations)
## Base des DOI
base_doi <- bib_df %>%
filter(NOTE %in% c("Article de revue scientifique à comité de lecture","Communication scientifique avec actes")) %>%
select(BIBTEXKEY,AUTHOR,TITLE,DOI) %>%
mutate(DOI = str_remove_all(DOI,"http://dx.doi.org/")) %>%
filter(!BIBTEXKEY %in% doi_ok$BIBTEXKEY) %>%
bind_rows(doi_ok) %>% drop_na(DOI)
Scopus_Request <- base_doi %>%
mutate(request = paste0("DOI(",DOI,")")) %>%
pull(request) %>%
paste0(collapse = " OR ")
Scopus_Request
scopus_data <- readFiles("bdd_biblio/scopus_doi.bib") %>%
convert2df(dbsource = "scopus", format = "bibtex") %>% tbl_df() %>%
select(DOI = DI,nb_citations = TC) %>%
arrange(desc(nb_citations))
new_bib_df <- scopus_data %>%
mutate(DOI = tolower(DOI)) %>%
inner_join(base_doi %>% mutate(DOI = tolower(DOI)), by = "DOI") %>%
select(BIBTEXKEY,nb_citations) %>%
bind_rows(citations) %>%
full_join(bib_df, by = "BIBTEXKEY")
new_bib_df %>% filter(is.na(nb_citations) & NOTE == "Article de revue scientifique à comité de lecture") %>% select(BIBTEXKEY,AUTHOR,TITLE, DOI)
new_bib_df <- scopus_data %>%
mutate(DOI = tolower(DOI)) %>%
inner_join(base_doi %>% mutate(DOI = tolower(DOI)), by = "DOI") %>%
select(BIBTEXKEY,nb_citations) %>%
bind_rows(citations) %>%
full_join(bib_df, by = "BIBTEXKEY")
new_bib_df %>% filter(is.na(nb_citations))
new_bib_df %>% filter(!is.na(nb_citations))
new_bib_df %>% filter(!is.na(nb_citations)) %>% count(NOTE)
new_bib_df %>% count(NOTE)
16+82
## Base des DOI
base_doi <- bib_df %>%
filter(NOTE %in% c("Article de revue scientifique à comité de lecture","Communication scientifique avec actes","Article de revue technique à comité de lecture")) %>%
select(BIBTEXKEY,AUTHOR,TITLE,DOI) %>%
mutate(DOI = str_remove_all(DOI,"http://dx.doi.org/")) %>%
filter(!BIBTEXKEY %in% doi_ok$BIBTEXKEY) %>%
bind_rows(doi_ok) %>% drop_na(DOI)
## Base des DOI
base_doi <- bib_df %>%
filter(NOTE %in% c("Article de revue scientifique à comité de lecture","Communication scientifique avec actes","Article de revue technique à comité de lecture")) %>%
select(BIBTEXKEY,AUTHOR,TITLE,DOI) %>%
mutate(DOI = str_remove_all(DOI,"http://dx.doi.org/")) %>%
filter(!BIBTEXKEY %in% doi_ok$BIBTEXKEY) %>%
bind_rows(doi_ok) %>% drop_na(DOI)
Scopus_Request <- base_doi %>%
mutate(request = paste0("DOI(",DOI,")")) %>%
pull(request) %>%
paste0(collapse = " OR ")
Scopus_Request
## On refait la jointure avec les données, et on ajoute les données de citation
new_bib_df <- scopus_data %>%
mutate(DOI = tolower(DOI)) %>%
inner_join(base_doi %>% mutate(DOI = tolower(DOI)), by = "DOI") %>%
select(BIBTEXKEY,nb_citations) %>%
bind_rows(citations) %>%
full_join(bib_df, by = "BIBTEXKEY")
# TODO :
# Définir le statut de chercheur pour les métriques "nombre de publications par chercheur" (chez EABX, ils ont pris CR/DR). Et récupérer (Cathy ?) une liste des statuts
# Traiter les éventuels conflits de noms composés
# Effectuer les requêtes WoS et Scopus pour obtenir le nombre de citations
library(tidyverse)
library(purrr)
## Package pour l'import de .bib
library(bib2df)
## Thème INRAE
source("R/theme_inrae.R")
# Liste des fichiers bib irsteadoc
list_bib <- list.files(pattern = ".bib")
# Import et mise en tableau
bib_df <- purrr::map_df(list_bib,bib2df::bib2df)
# 1. Barplot du nombre d'entrées par catégorie (tout auteur con --------
bib_df %>% select(NOTE, AUTHOR, TITLE, YEAR) %>%
unnest(AUTHOR) %>%
group_by(YEAR,NOTE) %>%
summarise(n = n_distinct(TITLE)) %>%
ungroup() %>%
arrange(desc(n)) %>%
ggplot(aes(x = reorder(NOTE, n), y = n)) +
geom_col(color = "black", aes(fill = NOTE))+
geom_label(aes(label = n)) +
facet_wrap(~YEAR, scales = "free") +
guides(fill = FALSE) +
coord_flip() +
theme_inrae() +
labs(title = "Nombre d'entrées bibliographiques par catégorie de document", subtitle = "Tous les agents confondus") +
theme(axis.title = element_blank()) +
ggsave("Figures/Barplot_entrees_document.png", dpi = "retina", width = 17, height = 8.79)
# 2. Nombre d'ACL (article comité de lecture) par année ----------------------
## Note : J'ai compté les actes de colloques comme ACL.
## Tout auteur confondu
bib_df %>% select(NOTE, AUTHOR, TITLE, YEAR) %>%
unnest(AUTHOR) %>%
group_by(YEAR, NOTE) %>%
filter(NOTE %in% c("Article de revue scientifique à comité de lecture","Communication scientifique avec actes","Article de revue technique à comité de lecture")) %>%
summarise(n = n_distinct(TITLE)) %>%
mutate(n_publi = sum(n)) %>%
ungroup() %>%
arrange(YEAR) %>%
mutate(YEAR = as.character(YEAR)) %>%
ggplot(aes(x = YEAR, y = n)) +
geom_col(color = "black", aes(fill = NOTE))+
geom_label(aes(y = n_publi,label = n_publi)) +
scale_fill_inrae(name = "Catégorie")+
theme_inrae() +
theme(axis.title.x = element_blank())+
labs(title = "Nombre d'ACL par année", subtitle = "Tous les agents confondus", y = "Nombre d'ACL")  +
ggsave("Figures/Barplot_ACL_Annee.png", dpi = "retina", width = 13.2, height = 8.79)
## Chercheurs uniquement
# 3. Top 10 auteurs ETBX (a garder en interne je suppose...) --------------------------------------------------
# Pour déterminer quels auteurs sont rattachés à ETBX, on se base sur le champs 'AFFILIATION', qui demande quelques remaniements (car AUTHORS est sous forme de liste et AFFILIATION sous forme de string séparé par des ;). Il y 5 entrées qui sont problématiques (pas le meme nombre d'auteur et d"affilliation) et à corriger manuellement (pour le moment retirées) :
a_traiter <-  c("PUB00057566","PUB00057565","PUB00061139","PUB00063885","PUB00056781")
## Attention il faudra regrouper manuellement certains noms composés ... Adeline Alonso-Ugaglia par exemple de BSA y est 2 fois (et ça a sûrement pu arriver pour des gens d'ETBX). Dans ce cas là, les noter et on fusionnera ici ces noms avant de faire des stats/graphes.
auteurs_ETBX <- bib_df %>%
select(AUTHOR,AFFILIATION, BIBTEXKEY) %>%
filter(!BIBTEXKEY %in% a_traiter) %>%
rowwise() %>%
mutate(AFFILIATION = list(as.list(strsplit(AFFILIATION, ";")[[1]]))) %>%
unnest() %>%
unnest() %>%
mutate(AFFILIATION = str_trim(AFFILIATION)) %>%
filter(AFFILIATION %in% c("IRSTEA BORDEAUX UR ETBX FRA","INRAE BORDEAUX UR ETBX FRA")) %>%
distinct(AUTHOR) %>%
pull()
top_10_auteurs <- bib_df %>%
select(BIBTEXKEY,NOTE, AUTHOR, TITLE, YEAR, AFFILIATION) %>%
unnest(AUTHOR) %>%
filter(AUTHOR %in% auteurs_ETBX) %>%
group_by(AUTHOR) %>%
summarise(n_key = n_distinct(BIBTEXKEY)) %>%
ungroup() %>%
arrange(desc(n_key)) %>%
slice(1:10) %>% pull(AUTHOR)
## 3.1 Top d'entrées par auteur ETBX
bib_df %>% select(BIBTEXKEY,NOTE, AUTHOR, TITLE, YEAR, AFFILIATION) %>%
unnest(AUTHOR) %>%
filter(AUTHOR %in% auteurs_ETBX) %>%
group_by(AUTHOR) %>%
summarise(n_key = n_distinct(BIBTEXKEY)) %>%
ungroup() %>%
arrange(desc(n_key)) %>%
filter(AUTHOR %in% top_10_auteurs) %>%
ggplot(aes(x = reorder(AUTHOR, n_key), y =  n_key)) +
geom_col(fill = "#00a3a6", color = "black") +
geom_label(aes(label = n_key)) +
coord_flip() +
guides(fill = FALSE) +
theme_inrae() +
labs(y = "Nombre d'entrées")+
theme(axis.title.y = element_blank())
## 3.2 Top d'ACL par auteur ETBX
bib_df %>% select(BIBTEXKEY,NOTE, AUTHOR, TITLE, YEAR, AFFILIATION) %>%
unnest(AUTHOR) %>%
filter(AUTHOR %in% auteurs_ETBX) %>%
filter(NOTE %in% c("Article de revue scientifique à comité de lecture","Communication scientifique avec actes","Article de revue technique à comité de lecture")) %>%
group_by(AUTHOR) %>%
summarise(n_key = n_distinct(BIBTEXKEY)) %>%
ungroup() %>%
arrange(desc(n_key)) %>%
filter(AUTHOR %in% top_10_auteurs) %>%
ggplot(aes(x = reorder(AUTHOR, n_key), y =  n_key)) +
geom_col(fill = "#00a3a6", color = "black") +
geom_label(aes(label = n_key)) +
coord_flip() +
guides(fill = FALSE) +
theme_inrae() +
labs(y = "Nombre d'ACL")+
theme(axis.title.y = element_blank())
# 4. Requête nombre de citations -------------------------------------------
## J'ai retrouvé quelques DOI à la main
complement_doi <- read_csv2("complement_doi.csv")
## Ces 16 entrées ne sont que dans HAL (aucune info citation)
doi_hal <- complement_doi %>% filter(str_detect(DOI,"hal-"))
## Ces entrées ont un DOI OK à ajouter
doi_ok <- complement_doi %>% filter(str_detect(DOI,"10.")) %>% select(-citations)
## Ces entrées n'ont pas de DOI mais j'ai relevé quand possible leur nombre de citations
citations <- complement_doi %>% filter(!is.na(citations)) %>% rename(nb_citations=citations) %>%
select(BIBTEXKEY,nb_citations)
## Base des DOI actualisée
base_doi <- bib_df %>%
filter(NOTE %in% c("Article de revue scientifique à comité de lecture","Communication scientifique avec actes","Article de revue technique à comité de lecture")) %>%
select(BIBTEXKEY,AUTHOR,TITLE,DOI) %>%
mutate(DOI = str_remove_all(DOI,"http://dx.doi.org/")) %>%
filter(!BIBTEXKEY %in% doi_ok$BIBTEXKEY) %>%
bind_rows(doi_ok) %>% drop_na(DOI)
## 1ère requête par le DOI : 58 publis retrouvées sur Scopus (+ que sur WoS)
Scopus_Request <- base_doi %>%
mutate(request = paste0("DOI(",DOI,")")) %>%
pull(request) %>%
paste0(collapse = " OR ")
scopus_data <- readFiles("bdd_biblio/scopus_doi.bib") %>%
convert2df(dbsource = "scopus", format = "bibtex") %>% tbl_df() %>%
select(DOI = DI,nb_citations = TC) %>%
arrange(desc(nb_citations))
## On refait la jointure avec les données, et on ajoute les données de citation
new_bib_df <- scopus_data %>%
mutate(DOI = tolower(DOI)) %>%
inner_join(base_doi %>% mutate(DOI = tolower(DOI)), by = "DOI") %>%
select(BIBTEXKEY,nb_citations) %>%
bind_rows(citations) %>%
full_join(bib_df, by = "BIBTEXKEY")
# WoS_request <- base_doi %>%
# mutate(request = paste0("DO=(",DOI,")")) %>%
# pull(request) %>%
# paste0(collapse = " OR ")
#
# readFiles("bdd_biblio/wos_doi.bib") %>%
#   convert2df(dbsource = "wos", format = "bibtex") %>%
#   tbl_df() %>%
#   select(DOI = DI,nb_citations = TC) %>%
#   arrange(desc(nb_citations)) %>% drop_na(nb_citations)
# TODO :
# Définir le statut de chercheur pour les métriques "nombre de publications par chercheur" (chez EABX, ils ont pris CR/DR). Et récupérer (Cathy ?) une liste des statuts
# Traiter les éventuels conflits de noms composés
# Effectuer les requêtes WoS et Scopus pour obtenir le nombre de citations
library(tidyverse)
library(purrr)
## Package pour l'import de .bib
library(bib2df)
## Thème INRAE
source("R/theme_inrae.R")
# Liste des fichiers bib irsteadoc
list_bib <- list.files(pattern = ".bib")
# Import et mise en tableau
bib_df <- purrr::map_df(list_bib,bib2df::bib2df)
# 1. Barplot du nombre d'entrées par catégorie (tout auteur con --------
bib_df %>% select(NOTE, AUTHOR, TITLE, YEAR) %>%
unnest(AUTHOR) %>%
group_by(YEAR,NOTE) %>%
summarise(n = n_distinct(TITLE)) %>%
ungroup() %>%
arrange(desc(n)) %>%
ggplot(aes(x = reorder(NOTE, n), y = n)) +
geom_col(color = "black", aes(fill = NOTE))+
geom_label(aes(label = n)) +
facet_wrap(~YEAR, scales = "free") +
guides(fill = FALSE) +
coord_flip() +
theme_inrae() +
labs(title = "Nombre d'entrées bibliographiques par catégorie de document", subtitle = "Tous les agents confondus") +
theme(axis.title = element_blank()) +
ggsave("Figures/Barplot_entrees_document.png", dpi = "retina", width = 17, height = 8.79)
# 2. Nombre d'ACL (article comité de lecture) par année ----------------------
## Note : J'ai compté les actes de colloques comme ACL.
## Tout auteur confondu
bib_df %>% select(NOTE, AUTHOR, TITLE, YEAR) %>%
unnest(AUTHOR) %>%
group_by(YEAR, NOTE) %>%
filter(NOTE %in% c("Article de revue scientifique à comité de lecture","Communication scientifique avec actes")) %>%
summarise(n = n_distinct(TITLE)) %>%
mutate(n_publi = sum(n)) %>%
ungroup() %>%
arrange(YEAR) %>%
mutate(YEAR = as.character(YEAR)) %>%
ggplot(aes(x = YEAR, y = n)) +
geom_col(color = "black", aes(fill = NOTE))+
geom_label(aes(y = n_publi,label = n_publi)) +
scale_fill_inrae(name = "Catégorie")+
theme_inrae() +
theme(axis.title.x = element_blank())+
labs(title = "Nombre d'ACL par année", subtitle = "Tous les agents confondus", y = "Nombre d'ACL")  +
ggsave("Figures/Barplot_ACL_Annee.png", dpi = "retina", width = 13.2, height = 8.79)
## Chercheurs uniquement
# 3. Top 10 auteurs ETBX (a garder en interne je suppose...) --------------------------------------------------
# Pour déterminer quels auteurs sont rattachés à ETBX, on se base sur le champs 'AFFILIATION', qui demande quelques remaniements (car AUTHORS est sous forme de liste et AFFILIATION sous forme de string séparé par des ;). Il y 5 entrées qui sont problématiques (pas le meme nombre d'auteur et d"affilliation) et à corriger manuellement (pour le moment retirées) :
a_traiter <-  c("PUB00057566","PUB00057565","PUB00061139","PUB00063885","PUB00056781")
## Attention il faudra regrouper manuellement certains noms composés ... Adeline Alonso-Ugaglia par exemple de BSA y est 2 fois (et ça a sûrement pu arriver pour des gens d'ETBX). Dans ce cas là, les noter et on fusionnera ici ces noms avant de faire des stats/graphes.
auteurs_ETBX <- bib_df %>%
select(AUTHOR,AFFILIATION, BIBTEXKEY) %>%
filter(!BIBTEXKEY %in% a_traiter) %>%
rowwise() %>%
mutate(AFFILIATION = list(as.list(strsplit(AFFILIATION, ";")[[1]]))) %>%
unnest() %>%
unnest() %>%
mutate(AFFILIATION = str_trim(AFFILIATION)) %>%
filter(AFFILIATION %in% c("IRSTEA BORDEAUX UR ETBX FRA","INRAE BORDEAUX UR ETBX FRA")) %>%
distinct(AUTHOR) %>%
pull()
top_10_auteurs <- bib_df %>%
select(BIBTEXKEY,NOTE, AUTHOR, TITLE, YEAR, AFFILIATION) %>%
unnest(AUTHOR) %>%
filter(AUTHOR %in% auteurs_ETBX) %>%
group_by(AUTHOR) %>%
summarise(n_key = n_distinct(BIBTEXKEY)) %>%
ungroup() %>%
arrange(desc(n_key)) %>%
slice(1:10) %>% pull(AUTHOR)
## 3.1 Top d'entrées par auteur ETBX
bib_df %>% select(BIBTEXKEY,NOTE, AUTHOR, TITLE, YEAR, AFFILIATION) %>%
unnest(AUTHOR) %>%
filter(AUTHOR %in% auteurs_ETBX) %>%
group_by(AUTHOR) %>%
summarise(n_key = n_distinct(BIBTEXKEY)) %>%
ungroup() %>%
arrange(desc(n_key)) %>%
filter(AUTHOR %in% top_10_auteurs) %>%
ggplot(aes(x = reorder(AUTHOR, n_key), y =  n_key)) +
geom_col(fill = "#00a3a6", color = "black") +
geom_label(aes(label = n_key)) +
coord_flip() +
guides(fill = FALSE) +
theme_inrae() +
labs(y = "Nombre d'entrées")+
theme(axis.title.y = element_blank())
## 3.2 Top d'ACL par auteur ETBX
bib_df %>% select(BIBTEXKEY,NOTE, AUTHOR, TITLE, YEAR, AFFILIATION) %>%
unnest(AUTHOR) %>%
filter(AUTHOR %in% auteurs_ETBX) %>%
filter(NOTE %in% c("Article de revue scientifique à comité de lecture","Communication scientifique avec actes")) %>%
group_by(AUTHOR) %>%
summarise(n_key = n_distinct(BIBTEXKEY)) %>%
ungroup() %>%
arrange(desc(n_key)) %>%
filter(AUTHOR %in% top_10_auteurs) %>%
ggplot(aes(x = reorder(AUTHOR, n_key), y =  n_key)) +
geom_col(fill = "#00a3a6", color = "black") +
geom_label(aes(label = n_key)) +
coord_flip() +
guides(fill = FALSE) +
theme_inrae() +
labs(y = "Nombre d'ACL")+
theme(axis.title.y = element_blank())
# 4. Requête nombre de citations -------------------------------------------
## J'ai retrouvé quelques DOI à la main
complement_doi <- read_csv2("complement_doi.csv")
## Ces 16 entrées ne sont que dans HAL (aucune info citation)
doi_hal <- complement_doi %>% filter(str_detect(DOI,"hal-"))
## Ces entrées ont un DOI OK à ajouter
doi_ok <- complement_doi %>% filter(str_detect(DOI,"10.")) %>% select(-citations)
## Ces entrées n'ont pas de DOI mais j'ai relevé quand possible leur nombre de citations
citations <- complement_doi %>% filter(!is.na(citations)) %>% rename(nb_citations=citations) %>%
select(BIBTEXKEY,nb_citations)
## Base des DOI actualisée
base_doi <- bib_df %>%
filter(NOTE %in% c("Article de revue scientifique à comité de lecture","Communication scientifique avec actes","Article de revue technique à comité de lecture")) %>%
select(BIBTEXKEY,AUTHOR,TITLE,DOI) %>%
mutate(DOI = str_remove_all(DOI,"http://dx.doi.org/")) %>%
filter(!BIBTEXKEY %in% doi_ok$BIBTEXKEY) %>%
bind_rows(doi_ok) %>% drop_na(DOI)
## 1ère requête par le DOI : 58 publis retrouvées sur Scopus (+ que sur WoS)
Scopus_Request <- base_doi %>%
mutate(request = paste0("DOI(",DOI,")")) %>%
pull(request) %>%
paste0(collapse = " OR ")
scopus_data <- readFiles("bdd_biblio/scopus_doi.bib") %>%
convert2df(dbsource = "scopus", format = "bibtex") %>% tbl_df() %>%
select(DOI = DI,nb_citations = TC) %>%
arrange(desc(nb_citations))
## On refait la jointure avec les données, et on ajoute les données de citation
new_bib_df <- scopus_data %>%
mutate(DOI = tolower(DOI)) %>%
inner_join(base_doi %>% mutate(DOI = tolower(DOI)), by = "DOI") %>%
select(BIBTEXKEY,nb_citations) %>%
bind_rows(citations) %>%
full_join(bib_df, by = "BIBTEXKEY")
# WoS_request <- base_doi %>%
# mutate(request = paste0("DO=(",DOI,")")) %>%
# pull(request) %>%
# paste0(collapse = " OR ")
#
# readFiles("bdd_biblio/wos_doi.bib") %>%
#   convert2df(dbsource = "wos", format = "bibtex") %>%
#   tbl_df() %>%
#   select(DOI = DI,nb_citations = TC) %>%
#   arrange(desc(nb_citations)) %>% drop_na(nb_citations)
new_bib_df
new_bib_df %>% filter(!is.na(nb_citations))
moy_citations_an <- new_bib_df %>% group_by(YEAR) %>% summarise(nb_citations_moy = mean(nb_citations,na.rm=TRUE))
moy_citations_an
moy_citations_an <- new_bib_df %>% group_by(YEAR) %>% summarise(nb_citations = sum(nb_citations,na.rm=TRUE))
nb_citations_an <- new_bib_df %>% group_by(YEAR) %>% summarise(nb_citations = sum(nb_citations,na.rm=TRUE))
nb_citations_an
nb_moy_citation_an <- mean(nb_citations_an$nb_citations)
nb_moy_citation_an
nb_moy_citation_an <- mean(nb_citations_an$nb_citations[-4])
nb_citations_an
nb_moy_citation_an <- mean(nb_citations_an$nb_citations[-4])
nb_moy_citation_an
56+39+24+5
