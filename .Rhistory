# Les onglets à 2 lignes sont à chaque fois vide (car la colonne n° a été remplie pour 1 et 2)
# sauf pour 4 onglets particuliers qui sont ici rajoutés.
Onglets_non_empty <- tab_dim %>%
filter(nb_lignes != 2) %>%
pull(Onglet) %>%
c("ii_3_activ_consult","iii_1_elearning", "i_9_contrats_internationaux","i_1_articles_synth")
# On affiche le tableau (Seulement le top 10)
tab_dim %>% filter(Onglet %in% Onglets_non_empty) %>%
slice(1:10)
# Chunk 6
## Extraction des projets nationaux
projets_nationaux <- ANX4$i_9_contrats_nationaux %>%
clean_names() %>%
select(-x11) %>%
drop_na(contrat) %>% drop_na(date_debut) %>% mutate(type = "National")
## Projets européens
projets_europ <- ANX4$i_9_contrats_europ_autres %>% drop_na(`Date début`) %>% clean_names() %>%
mutate_at(vars(date_debut:date_fin), as.Date) %>% mutate(type = "Européen")
## Projets internationaux
projets_inter <- ANX4$i_9_contrats_internationaux %>% clean_names() %>%
mutate_at(vars(date_debut:date_fin), as.Date) %>% mutate(type = "International")
## Projets R&D
projets_rd <- ANX4$i_9_contrats_prive_r_d_indus %>% clean_names() %>%
mutate_at(vars(date_debut:date_fin), as.Date) %>% mutate(type = "R&D")
## Projets PIA
projets_pia <- ANX4$i_9_contrats_pia %>% clean_names() %>%  drop_na(contrat,date_debut) %>%
mutate_at(vars(date_debut:date_fin), as.Date) %>% mutate(type = "PIA")
## Projets de collectivités territoriales
projets_coll_terri <- ANX4$i_9_contrats_coll_territ %>% clean_names() %>%  drop_na(contrat,date_debut, date_fin) %>%
mutate_at(vars(date_debut), as.Date, origin = "1899-12-31") %>% mutate(type = "National")
## On assemble le tout
PRJ <- bind_rows(projets_nationaux,projets_europ)%>%
bind_rows(projets_inter) %>%
bind_rows(projets_rd) %>%
bind_rows(projets_pia) %>%
bind_rows(projets_coll_terri) %>%
mutate_at(vars(porteur:axe_3), replace_cases) %>% unique() %>%
mutate(date_fin = replace_na(date_fin, "2024-01-01")) %>%
mutate(porteur = recode(porteur, "0" = "Non porteur", "1"="Porteur")) %>%
mutate(porteur = factor(porteur, levels = c("Porteur", "Non porteur"))) %>%
group_by(contrat) %>%
summarise(date_debut = min(date_debut),
date_fin = max(date_fin),
porteur = unique(porteur),
type = unique(type)) %>%
ungroup() %>%
arrange(date_debut) %>%
mutate(contrat = factor(contrat, levels = unique(contrat)))
# Chunk 7
## Production du graphique
ggplot(PRJ, aes(x = date_fin, y = contrat)) +
geom_segment(aes(x = date_debut, xend = date_fin, y = contrat, yend = contrat, color = type), size = 3.5) +
scale_y_discrete(limits = rev(levels(PRJ$contrat))) +
geom_point(fill = "black", color = "black", size = 3, aes(shape = porteur)) +
geom_point(aes(x = date_debut, y = contrat, shape = porteur), color ="black", fill = "black", size = 3) +
theme_inrae() +
theme(axis.text.y = element_text(size = 10)) +
geom_vline(xintercept = as.Date("2020-06-01"), color = "blue", size = 4) +
labs(x = "Temps", y = "Contrats", color = "Type de contrat", shape = "ETBX porteur ?")
# Chunk 8
PRJ %>%
mutate(annee_debut = lubridate::year(date_debut),
annee_fin = lubridate::year(date_fin)) %>%
group_by(annee_debut) %>%
count(type) %>%
spread(key = annee_debut, value = n) %>% ungroup() %>%
mutate_at(vars(`2013`:`2019`),replace_na,0)
# Chunk 9
PRJ %>%
mutate(annee_debut = lubridate::year(date_debut),
annee_fin = lubridate::year(date_fin)) %>%
group_by(annee_fin) %>%
count(type) %>%
spread(key = annee_fin, value = n) %>% ungroup() %>%
mutate_at(vars(`2017`:`2025`),replace_na,0)
# Chunk 10
par_an <- PRJ %>%
mutate(annee_debut = lubridate::year(date_debut),
annee_fin = lubridate::year(date_fin))
l <- list()
for(i in 2014:2020) {
l[[as.character(i)]] <- par_an %>% filter(annee_debut <= i & annee_fin >= i) %>% mutate(an = i)
}
count_type <- function(df) {
df %>% group_by(type,an) %>% count() %>% arrange(desc(n))
}
map(l,count_type) %>% bind_rows() %>%
spread(key = an, value = n) %>% ungroup() %>%
mutate_at(vars(`2014`:`2020`),replace_na,0)
# Chunk 11
acl1 <- ANX4$i_1_articles_sctfq %>%
clean_names() %>%
mutate(year = stringr::str_extract(reference_complete,'\\d{4}')) %>%
drop_na(year) %>%
group_by(year) %>%
summarise(n = n_distinct(reference_complete)) %>%
spread(key = year, value = n) %>%
mutate(Type = "Articles")
acl2 <- ANX4$i_1_autres_articles %>%
clean_names() %>%
mutate(year = stringr::str_extract(reference_complete,'\\d{4}')) %>%
filter(year != 2016) %>%
drop_na(year) %>%
group_by(year) %>%
summarise(n = n_distinct(reference_complete)) %>%
spread(key = year, value = n) %>%
mutate(Type = "Autres articles")
acl3 <- ANX4$i_3_articles_actes_colloq %>%
clean_names() %>%
mutate(year = stringr::str_extract(reference_complete,'\\d{4}')) %>%
drop_na(year) %>%
group_by(year) %>%
summarise(n = n_distinct(reference_complete)) %>% spread(key = year, value = n) %>% mutate(Type = "Actes colloques")
acl4 <- ANX4$i_2_chap_ouvrages %>%
clean_names() %>%
mutate(year = stringr::str_extract(reference_complete,'\\d{4}')) %>%
drop_na(year) %>%
group_by(year) %>%
summarise(n = n_distinct(reference_complete)) %>% spread(key = year, value = n) %>% mutate(Type = "Chapitres ouvrages")
bind_rows(acl1,acl2,acl3,acl4) %>%
select(Type,`2017`:`2020`)
# Chunk 12
word_count <- ANX4$i_1_articles_sctfq %>%
clean_names() %>%
group_by(journal) %>%
count() %>% arrange(desc(n)) %>%
ungroup() %>%
rowwise() %>%
mutate(n = ifelse(journal == "Journal of Water Resources Planning and Management", yes = 7, no = n)) %>%
mutate(journal = ifelse(journal == "Journal of Water Resources Planning and Management", yes = "Water Res. Planning and Management", no = journal)) %>%
ungroup() %>%  mutate(journal = str_to_lower(journal)) %>%
mutate(journal = str_trim(journal))
# wordcloud2(word_count, size = 0.35)
# Chunk 13
articles <- ANX4$i_1_articles_sctfq %>%
clean_names() %>%
group_by(journal) %>%
count() %>% arrange(desc(n)) %>%
mutate(journal = str_to_lower(journal)) %>%
mutate(journal = str_trim(journal))
tab_relecture_articles <- ANX4$i_8_evaluation_articles %>%
clean_names() %>%
select(revue_ouvrage, nombre_de_relectures) %>%
mutate(revue_ouvrage = str_to_lower(revue_ouvrage)) %>%
mutate(revue_ouvrage = str_trim(revue_ouvrage)) %>%
full_join(articles, by = c("revue_ouvrage"="journal")) %>%
arrange(revue_ouvrage) %>% unique() %>% group_by(revue_ouvrage) %>%
summarise(n_relecture = sum(nombre_de_relectures, na.rm=TRUE), n_publi = sum(n, na.rm=TRUE)) %>%
ungroup() %>%
unique()
# Top 10
tab_relecture_articles %>%
mutate(indicateur_som = n_relecture * n_publi) %>%
arrange(desc(indicateur_som))%>%
slice(1:10)
# Top 10
tab_relecture_articles %>%
mutate(indicateur_moy = (n_relecture + n_publi)/2) %>%
arrange(desc(indicateur_moy))%>%
slice(1:10)
tab_relecture_articles
tab_relecture_articles %>%
gather(key = type, value = value,-revue_ouvrage)
tab_relecture_articles %>%
gather(key = type, value = value,-revue_ouvrage) %>%
ggplot(aes(x = revue_ouvrage, y = value, fill = type)) +
geom_point(shape = 21)
tab_relecture_articles %>%
gather(key = type, value = value,-revue_ouvrage) %>%
ggplot(aes(x = revue_ouvrage, y = value, fill = type)) +
geom_point(shape = 21) +
theme(axis.text.x = element_text(angle = 90))
tab_relecture_articles %>%
gather(key = type, value = value,-revue_ouvrage) %>%
ggplot(aes(x = reorder(revue_ouvrage,value), y = value, fill = type)) +
geom_point(shape = 21) +
theme(axis.text.x = element_text(angle = 90))
tab_relecture_articles %>%
gather(key = type, value = value,-revue_ouvrage) %>%
ggplot(aes(x = reorder(revue_ouvrage,-value), y = value, fill = type)) +
geom_point(shape = 21) +
theme(axis.text.x = element_text(angle = 90))
tab_relecture_articles %>%
filter(n_relecture > 1 & n_publi > 1) %>%
gather(key = type, value = value,-revue_ouvrage) %>%
ggplot(aes(x = reorder(revue_ouvrage,-value), y = value, fill = type)) +
geom_point(shape = 21) +
theme(axis.text.x = element_text(angle = 90))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
gather(key = type, value = value,-revue_ouvrage) %>%
ggplot(aes(x = reorder(revue_ouvrage,-value), y = value, fill = type)) +
geom_point(shape = 21) +
theme(axis.text.x = element_text(angle = 90))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
gather(key = type, value = value,-revue_ouvrage) %>%
ggplot(aes(x = reorder(revue_ouvrage,-value), y = value, fill = type)) +
geom_point(shape = 21) +
theme(axis.text.x = element_text(angle = 90))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0)
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_point(aes(y = n_publi, fill = "red",color = "black",shape = 21)) +
geom_point(aes(y = n_relecture, fill = "blue",color = "black",shape = 21)) +
theme(axis.text.x = element_text(angle = 90))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_point(aes(y = n_publi), fill = "red",color = "black",shape = 21) +
geom_point(aes(y = n_relecture), fill = "blue",color = "black",shape = 21) +
theme(axis.text.x = element_text(angle = 90))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = x = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi), fill = "red",color = "black",shape = 21) +
geom_point(aes(y = n_relecture), fill = "blue",color = "black",shape = 21) +
theme(axis.text.x = element_text(angle = 90))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi), fill = "red",color = "black",shape = 21) +
geom_point(aes(y = n_relecture), fill = "blue",color = "black",shape = 21) +
theme(axis.text.x = element_text(angle = 90))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi), fill = "red",color = "black",shape = 21, size = 4) +
geom_point(aes(y = n_relecture), fill = "blue",color = "black",shape = 21) +
theme(axis.text.x = element_text(angle = 90))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi), fill = "red",color = "black",shape = 21, size = 4) +
geom_point(aes(y = n_relecture), fill = "blue",color = "black",shape = 21, size = 4) +
theme(axis.text.x = element_text(angle = 90))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi), fill = "red",color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = n_relecture), fill = "blue",color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi), fill = "red",color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = n_relecture), fill = "blue",color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Revues", y = "Nombre")
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi), fill = "red",color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = n_relecture), fill = "blue",color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Revues", y = "Nombre") +
scale_y_continuous(breaks = 1:30)
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi), fill = "red",color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = n_relecture), fill = "blue",color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Revues", y = "Nombre") +
scale_y_continuous(breaks = seq(1,30,2))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi), fill = "red",color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = n_relecture), fill = "blue",color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Revues", y = "Nombre") +
scale_y_continuous(breaks = seq(0,30,2))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi, aes(fill = "Nombre de publications")),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = n_relecture, aes(fill = "Nombre de relectures")), fill = "blue",color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Revues", y = "Nombre") +
scale_y_continuous(breaks = seq(0,30,2))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi, aes(fill = "Nombre de publications")),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = n_relecture, aes(fill = "Nombre de relectures")),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Revues", y = "Nombre") +
scale_y_continuous(breaks = seq(0,30,2))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi, aes(fill = "Nombre de publications")),color = "black",shape = 21, size = 4, alpha = 0.8)
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8)
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = n_relecture, fill = "Nombre de relectures"),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Revues", y = "Nombre") +
scale_y_continuous(breaks = seq(0,30,2))
tab_relecture_articles %>%
filter(n_relecture > 0 & n_publi > 0) %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = n_relecture, fill = "Nombre de relectures"),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Revues", y = "Nombre", fill = "Type") +
scale_y_continuous(breaks = seq(0,30,2))
tab_relecture_articles %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = n_relecture, fill = "Nombre de relectures"),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Revues", y = "Nombre", fill = "Type") +
scale_y_continuous(breaks = seq(0,30,2))
tab_relecture_articles %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = n_relecture, fill = "Nombre de relectures"),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Revues", y = "Nombre", fill = "Type") +
scale_y_continuous(breaks = seq(0,30,2)) +
coord_flip()
tab_relecture_articles %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = n_relecture, fill = "Nombre de relectures"),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
labs(x = "Revues", y = "Nombre", fill = "Type") +
scale_y_continuous(breaks = seq(0,30,2)) +
coord_flip()
tab_relecture_articles %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = n_relecture, fill = "Nombre de relectures"),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
labs(x = "Revues", y = "Nombre", fill = "Type") +
scale_y_continuous(breaks = seq(0,30,2)) +
coord_flip() +
theme(axis.text.y = element_text(size = 9))
tab_relecture_articles %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = n_relecture, fill = "Nombre de relectures"),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Revues", y = "Nombre", fill = "Type") +
scale_y_continuous(breaks = seq(0,30,2))
tab_relecture_articles %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = n_relecture, fill = "Nombre de relectures"),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90, size = 10)) +
labs(x = "Revues", y = "Nombre", fill = "Type") +
scale_y_continuous(breaks = seq(0,30,2))
tab_relecture_articles %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = -n_relecture, fill = "Nombre de relectures"),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90, size = 10)) +
labs(x = "Revues", y = "Nombre", fill = "Type") +
scale_y_continuous(breaks = seq(0,30,2))
tab_relecture_articles %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = -n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = -n_relecture, fill = "Nombre de relectures"),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90, size = 10)) +
labs(x = "Revues", y = "Nombre", fill = "Type") +
scale_y_continuous(breaks = seq(0,30,2))
tab_relecture_articles %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = -n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = -n_relecture, fill = "Nombre de relectures"),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90, size = 10)) +
labs(x = "Revues", y = "Nombre", fill = "Type") +
scale_y_continuous(breaks = seq(-30,12,2))
tab_relecture_articles %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = -n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = -n_relecture, fill = "Nombre de relectures"),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90, size = 10)) +
labs(x = "Revues", y = "Nombre", fill = "Type") +
geom_hline(yintercept = 0, size = 3) +
scale_y_continuous(breaks = seq(-30,12,2))
tab_relecture_articles %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_hline(yintercept = 0, size = 3) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = -n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = -n_relecture, fill = "Nombre de relectures"),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90, size = 10)) +
labs(x = "Revues", y = "Nombre", fill = "Type") +
scale_y_continuous(breaks = seq(-30,12,2))
tab_relecture_articles %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_hline(yintercept = 0, size = 2) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = -n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = -n_relecture, fill = "Nombre de relectures"),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90, size = 10)) +
labs(x = "Revues", y = "Nombre", fill = "Type") +
scale_y_continuous(breaks = seq(-30,12,2))
tab_relecture_articles %>%
ggplot(aes(x = reorder(revue_ouvrage,-n_publi))) +
geom_hline(yintercept = 0, size = 2) +
geom_segment(aes(x = reorder(revue_ouvrage,-n_publi), xend = reorder(revue_ouvrage,-n_publi),
y = n_publi, yend = -n_relecture)) +
geom_point(aes(y = n_publi, fill = "Nombre de publications"),color = "black",shape = 21, size = 4, alpha = 0.8) +
geom_point(aes(y = -n_relecture, fill = "Nombre de relectures"),color = "black",shape = 21, size = 4, alpha = 0.8) +
theme_inrae()  +
theme(axis.text.x = element_text(angle = 90, size = 10)) +
labs(x = "Revues", y = "Nombre", fill = "Type") +
scale_y_continuous(breaks = seq(-30,12,2))
word_count <- ANX4$i_1_articles_sctfq %>%
clean_names() %>%
group_by(journal) %>%
count() %>% arrange(desc(n)) %>%
ungroup() %>%
rowwise() %>%
mutate(n = ifelse(journal == "Journal of Water Resources Planning and Management", yes = 7, no = n)) %>%
mutate(journal = ifelse(journal == "Journal of Water Resources Planning and Management", yes = "Water Res. Planning and Management", no = journal)) %>%
ungroup() %>%  mutate(journal = str_to_lower(journal)) %>%
mutate(journal = str_trim(journal))
# wordcloud2(word_count, size = 0.35)
wordcloud2(word_count, size = 0.35)
wordcloud2(word_count, size = 0.35)
wordcloud2(word_count, size = 0.35)
install.packages("styler")
styler
styler:::style_active_file()
